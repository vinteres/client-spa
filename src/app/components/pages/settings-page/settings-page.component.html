<h1>Settings</h1>
<div *ngIf="!loading" class="accordion" id="accordionExample">

  <div class="container">
    <div class="nav-tabs-wrapper">
      <div class="vnav-tabs">
        <a [ngClass]="{'active' : ('account_info' === activeTab)}" (click)="changeTab('account_info')">Account Info</a>
        <a [ngClass]="{'active' : ('profile_info' === activeTab)}" (click)="changeTab('profile_info')">Profile Info</a>
        <a [ngClass]="{'active' : ('security' === activeTab)}" (click)="changeTab('security')">Security</a>
        <a [ngClass]="{'active' : ('account' === activeTab)}" (click)="changeTab('account')">Account</a>
      </div>
    </div>
  </div>

  <div *ngIf="'account_info' === activeTab" class="option-body rounded shadow">
    <form [formGroup]="accountInfoForm">
      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Name</label>
        <div class="col-sm-10">
          <div class="radio">
            <input class="form-control" type="text" name="name" formControlName="name">
          </div>
          <div>
            <small *ngIf="name.invalid && (name.dirty || name.touched)" class="text-danger">
              Invalid name
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Title</label>
        <div class="col-sm-10">
          <div class="radio">
            <input class="form-control" type="text" name="title" formControlName="title">
          </div>
          <div>
            <small *ngIf="title.invalid && (title.dirty || title.touched)" class="text-danger">
              Invalid title
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Email</label>
        <div class="col-sm-10">
          <div class="radio">
            <input class="form-control" disabled type="text" name="email" formControlName="email">
          </div>
          <div>
            <small *ngIf="email.invalid && (email.dirty || email.touched)" class="text-danger">
              Invalid email
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Birthday</label>
        <div class="col-sm-10">
          <date-picker [date]="birthday.value" (dateChange)="dateChange($event)"></date-picker>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">About me</label>
        <div class="col-sm-10">
          <div class="radio">
            <textarea class="form-control" name="description" formControlName="description"></textarea>
          </div>
          <div>
            <small *ngIf="description.invalid && (description.dirty || description.touched)" class="text-danger">
              Invalid description
            </small>
          </div>
        </div>
      </div>

    </form>
    <button class="btn btn-primary" (click)="saveAccountInfo()">Save</button>
  </div>

  <div *ngIf="'profile_info' === activeTab" class="option-body rounded shadow">

    <form [formGroup]="profileInfoForm">
      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Body type</label>
        <div class="col-sm-10">
          <div class="radio">
            <label><input type="radio" value="fit" name="body" formControlName="body">Fit</label>
          </div>
          <div class="radio">
            <label><input type="radio" value="curvy" name="body" formControlName="body">Curvy</label>
          </div>
          <div class="radio disabled">
            <label><input type="radio" value="average" name="body" formControlName="body">Average</label>
          </div>
          <div class="radio disabled">
            <label><input type="radio" value="skinny" name="body" formControlName="body">Skinny</label>
          </div>
          <div>
            <small *ngIf="body.invalid && (body.dirty || body.touched)" class="text-danger">
              Required field
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-2 col-form-label">Height</label>
        <div class="col-sm-8">
          <input type="number" class="form-control" formControlName="height" name="height" style="width: 70px; display: inline-block;">
          cm
          <div>
            <small *ngIf="height.invalid && (height.dirty || height.touched)" class="text-danger">
              Invalid height
            </small>
          </div>
        </div>
        <div class="col-sm-5">
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Smoking</label>
        <div class="col-sm-10">
          <div class="radio">
            <label><input type="radio" value="regularly" name="smoking" formControlName="smoking">Regularly</label>
          </div>
          <div class="radio">
            <label><input type="radio" value="sometimes" name="smoking" formControlName="smoking">Sometimes</label>
          </div>
          <div class="radio disabled">
            <label><input type="radio" value="never" name="smoking" formControlName="smoking">Never</label>
          </div>
          <div>
            <small *ngIf="smoking.invalid && (smoking.dirty || smoking.touched)" class="text-danger">
              Required field
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Drinking</label>
        <div class="col-sm-10">
          <div class="radio">
            <label><input type="radio" value="regularly" name="drinking" formControlName="drinking">Regularly</label>
          </div>
          <div class="radio">
            <label><input type="radio" value="sometimes" name="drinking" formControlName="drinking">Socially</label>
          </div>
          <div class="radio disabled">
            <label><input type="radio" value="never" name="drinking" formControlName="drinking">Never</label>
          </div>
          <div>
            <small *ngIf="drinking.invalid && (drinking.dirty || drinking.touched)" class="text-danger">
              Required field
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Has children</label>
        <div class="col-sm-10">
          <div class="radio">
            <label><input type="radio" value="has" name="children_status" formControlName="children_status">Yes</label>
          </div>
          <div class="radio">
            <label><input type="radio" value="does_not_have" name="children_status" formControlName="children_status">No</label>
          </div>
          <div>
            <small *ngIf="children_status.invalid && (children_status.dirty || children_status.touched)" class="text-danger">
              Required field
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-2 col-form-label">Has pets</label>
        <div class="col-sm-10">
          <div class="radio">
            <label><input type="radio" value="cat" name="pet_status" formControlName="pet_status">Cat(s)</label>
          </div>
          <div class="radio">
            <label><input type="radio" value="dog" name="pet_status" formControlName="pet_status">Dog(s)</label>
          </div>
          <div class="radio disabled">
            <label><input type="radio" value="other" name="pet_status" formControlName="pet_status">Other(s)</label>
          </div>
          <div class="radio disabled">
            <label><input type="radio" value="none" name="pet_status" formControlName="pet_status">None</label>
          </div>
          <div>
            <small *ngIf="pet_status.invalid && (pet_status.dirty || pet_status.touched)" class="text-danger">
              Required field
            </small>
          </div>
        </div>
      </div>

    </form>

    <button class="btn btn-primary" (click)="saveProfileInfo()">Save</button>
  </div>

  <div *ngIf="'security' === activeTab" class="option-body rounded shadow">
    <form [formGroup]="securityForm">
      <div class="form-group row">
        <label for="inputPassword" class="col-sm-3 col-form-label">Current password</label>
        <div class="col-sm-9">
          <div class="radio">
            <input class="form-control" type="password" name="password" formControlName="password">
          </div>
          <div>
            <small *ngIf="password.invalid && (password.dirty || password.touched)" class="text-danger">
              <div *ngIf="!password.errors['invalid']">Required field</div>
              <div *ngIf="password.errors['invalid']">Invalid password</div>
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-3 col-form-label">New password</label>
        <div class="col-sm-9">
          <div class="radio">
            <input class="form-control" type="password" name="newPassword" formControlName="newPassword">
          </div>
          <div>
            <small *ngIf="newPassword.invalid && (newPassword.dirty || newPassword.touched)" class="text-danger">
              <div *ngIf="newPassword.errors['required']">Required field</div>
              <div *ngIf="newPassword.errors['pattern']">Password must be at least 8 characters long and contain at least one uppercase letter, lowercase letter, number and special character</div>
            </small>
          </div>
        </div>
      </div>

      <div class="form-group row">
        <label for="inputPassword" class="col-sm-3 col-form-label">Confirm password</label>
        <div class="col-sm-9">
          <div class="radio">
            <input class="form-control" type="password" name="confirmPassword" formControlName="confirmPassword">
          </div>
          <div>
            <small *ngIf="confirmPassword.invalid && (confirmPassword.dirty || confirmPassword.touched)" class="text-danger">
              <div *ngIf="!confirmPassword.errors['does_not_match']">Confirm password</div>
              <div *ngIf="confirmPassword.errors['does_not_match']">Passwords do not match</div>
            </small>
          </div>
        </div>
      </div>

    </form>

    <button class="btn btn-primary" [disabled]="loadingSecurity" (click)="saveSecurity()">Save</button>
  </div>

  <div *ngIf="'account' === activeTab" class="option-body rounded shadow">

    <button class="btn btn-danger" (click)="openConfirmPassword(confirmPasswordDialog)">Deactivate account</button>
  </div>
</div>

<ng-template #confirmPasswordDialog let-modal>
  <div class="modal-body">
    <span class="close" aria-label="Close" style="position: absolute; top: -30px;right: 0; color: #fff; cursor: pointer;" (click)="modal.dismiss('Cross click')">&times;</span>
    <h4>Confirm password</h4>

    <div class="form-group required">
      <input type="password" class="form-control" [(ngModel)]='confirmPasswordModal' placeholder="Confirm your password" />
      <small *ngIf="confirmPasswordError" class="text-danger">
        Invalid password
      </small>
    </div>
    <button class="btn btn-outline-dark" (click)="deactivate()" [disabled]="!confirmPasswordModal || 0 === confirmPasswordModal.trim().length" style="width: 100%;">Deactivate</button>
  </div>
</ng-template>
